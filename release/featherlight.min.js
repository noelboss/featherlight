/**
 * Featherlight - ultra slim jQuery lightbox
 * Version 0.4.9 - http://noelboss.github.io/featherlight/
 *
 * Copyright 2014, NoÃ«l Raoul Bossart (http://www.noelboss.com)
 * MIT Licensed.
**/
!function(a){"use strict";function b(a,c){if(this.constructor!==b){var d=new b(a,c);return d.open(),d}this.id=b.id++,this.setup(a,c)}if("undefined"==typeof a)return void("console"in window&&window.console.info("Too much lightness, Featherlight needs jQuery."));var c=function(a){if(27===a.keyCode&&!a.isDefaultPrevented()){var c=b.current();c&&c.closeOnEsc&&(c.$instance.find("."+c.namespace+"-close:first").click(),a.preventDefault())}};b.prototype={constructor:b,namespace:"featherlight",targetAttr:"data-featherlight",variant:null,resetCss:!1,background:null,openTrigger:"click",closeTrigger:"click",filter:null,root:"body",openSpeed:250,closeSpeed:250,closeOnClick:"background",closeOnEsc:!0,closeIcon:"&#10005;",otherClose:null,beforeOpen:a.noop,beforeClose:a.noop,afterOpen:a.noop,afterClose:a.noop,type:null,contentFilters:["jquery","image","html","ajax","text"],setup:function(b,d){"object"!=typeof b||b instanceof a!=!1||d||(d=b,b=void 0);var e=a.extend(this,d,{target:b}),f=e.resetCss?e.namespace+"-reset":e.namespace,g=a(e.background||'<div class="'+f+'"><div class="'+f+'-content"><span class="'+f+"-close-icon "+e.namespace+'-close">'+e.closeIcon+"</span></div></div>"),h="."+e.namespace+"-close"+(e.otherClose?","+e.otherClose:"");return e.$instance=g.clone().addClass(e.variant),e.closeOnEsc&&c&&(a(document).bind("keyup."+this.constructor.prototype.namespace,c),c=null),e.$instance.on(e.closeTrigger+"."+e.namespace,function(b){var c=a(b.target);("background"===e.closeOnClick&&c.is("."+e.namespace)||"anywhere"===e.closeOnClick||c.is(h))&&(b.preventDefault(),e.close())}),this},getContent:function(){var b=this,c=this.constructor.contentFilters,d=function(a){return b.$currentTarget&&b.$currentTarget.attr(a)},e=d(b.targetAttr),f=b.target||e||"",g=c[b.type];if(!g&&f in c&&(g=c[f],f=b.target&&e),f=f||d("href")||"",!g)for(var h in c)b[h]&&(g=c[h],f=b[h]);if(!g){var i=f;if(f=null,a.each(b.contentFilters,function(){return g=c[this],g.test&&(f=g.test(i)),!f&&g.regex&&i.match&&i.match(g.regex)&&(f=i),!f}),!f)return"console"in window&&window.console.error("Featherlight: no content filter found "+(i?' for "'+i+'"':" (no target specified)")),!1}return g.process.call(b,f)},setContent:function(b){var c=this;return(b.is("iframe")||a("iframe",b).length>0)&&c.$instance.addClass(c.namespace+"-iframe"),c.$content=b.addClass(c.namespace+"-inner"),c.$instance.find("."+c.namespace+"-inner").remove(),c.$instance.find("."+c.namespace+"-content").append(c.$content),c},open:function(b){var c=this;if(b&&!b.isDefaultPrevented()||c.beforeOpen(b)!==!1){b&&b.preventDefault();var d=c.getContent();if(d)return c.constructor._opened.add(c._openedCallback=function(a){c.$instance.closest("body").length>0&&(a.currentFeatherlight=c)}),a.when(d).done(function(a){c.setContent(a).$instance.appendTo(c.root).fadeIn(c.openSpeed,function(){c.afterOpen(b)})}),c}return!1},close:function(a){var b=this;return b.beforeClose(a)===!1?!1:(b.constructor._opened.remove(b._openedCallback),void b.$instance.fadeOut(b.closeSpeed,function(){b.$instance.detach(),b.afterClose(a)}))}},a.extend(b,{id:0,autoBind:"[data-featherlight]",defaults:b.prototype,contentFilters:{jquery:{regex:/^[#.]\w/,test:function(b){return b instanceof a&&b},process:function(b){return a(b).clone(!0)}},image:{regex:/\.(png|jpg|jpeg|gif|tiff|bmp)(\?\S*)?$/i,process:function(b){var c=this,d=a.Deferred(),e=new Image;return e.onload=function(){d.resolve(a('<img src="'+b+'" alt="" class="'+c.namespace+'-image" />'))},e.onerror=function(){d.reject()},e.src=b,d.promise()}},html:{regex:/^\s*<[\w!][^<]*>/,process:function(b){return a(b)}},ajax:{regex:/./,process:function(b){var c=a.Deferred(),d=a("<div></div>").load(b,function(a,b){"error"!==b&&c.resolve(d.contents()),c.fail()});return c.promise()}},text:{process:function(b){return a("<div>",{text:b})}}},functionAttributes:["beforeOpen","afterOpen","beforeClose","afterClose"],readElementConfig:function(b){var c=this,d={};return b&&b.attributes&&a.each(b.attributes,function(){var b=this.name.match(/^data-featherlight-(.*)/);if(b){var e=this.value,f=a.camelCase(b[1]);if(a.inArray(f,c.functionAttributes)>=0)e=new Function(e);else try{e=a.parseJSON(e)}catch(g){}d[f]=e}}),d},attach:function(b,c,d){var e=this;"object"!=typeof c||c instanceof a!=!1||d||(d=c,c=void 0),d=a.extend({},d);var f=a.extend({},e.defaults,e.readElementConfig(b[0]),d);b.on(f.openTrigger+"."+f.namespace,f.filter,function(f){var g=a.extend({$currentTarget:a(this)},e.readElementConfig(b[0]),e.readElementConfig(this),d);new a.featherlight(c,g).open(f)})},current:function(){var a={};return this._opened.fire(a),a.currentFeatherlight},close:function(){var a=this.current();a&&a.close()},_opened:a.Callbacks()}),a.featherlight=b,a.fn.featherlight=function(a,c){return b.attach(this,a,c),this},a(document).ready(function(){b.autoBind&&(a(document).featherlight({filter:b.autoBind}),a(b.autoBind).filter("[data-featherlight-filter]").each(function(){a(this).featherlight()}))})}(jQuery);